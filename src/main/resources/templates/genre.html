<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MovieTime - Th·ªÉ Lo·∫°i Phim</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }

    .movie-card {
      min-width: 200px;
      max-width: 200px;
      flex-shrink: 0;
      text-align: center;
      transition: transform 0.3s ease;
    }

    .movie-card:hover {
      transform: scale(1.05);
    }

    .movie-card img {
      width: 100%;
      height: 300px;
      object-fit: cover;
      border-radius: 10px 10px 0 0;
    }

    .card-body {
      background-color: #ffffff;
      padding: 10px;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .section-title {
      font-size: 1.8rem;
      margin: 30px 0;
      font-weight: bold;
      color: #333;
    }

    .movie-section {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }

  </style>
</head>

<body>


<!-- Genre Movies Section -->
<div class="container my-5">
  <h2 class="section-title text-center" id="genre-title">üé¨ Th·ªÉ Lo·∫°i: </h2>
  <div id="movies-list" class="row movie-section">
    <!-- Danh s√°ch phim s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- JavaScript Fetch API -->
<script>
  const API_KEY = '5b3554c90c5c911c652788f8b65db269';
  const BASE_URL = 'https://api.themoviedb.org/3';

  // L·∫•y genreId v√† genreName t·ª´ URL
  const urlParams = new URLSearchParams(window.location.search);
  const genreId = urlParams.get('genreId');
  const genreName = urlParams.get('genreName');

  // Hi·ªÉn th·ªã t√™n th·ªÉ lo·∫°i
  document.getElementById('genre-title').innerText = `üé¨ Th·ªÉ Lo·∫°i: ${genreName}`;

  // G·ªçi API ƒë·ªÉ l·∫•y danh s√°ch phim theo th·ªÉ lo·∫°i
  async function fetchMoviesByGenre() {
    const apiUrl = `${BASE_URL}/discover/movie?api_key=${API_KEY}&with_genres=${genreId}&language=vi-VN`;

    try {
      const response = await fetch(apiUrl);
      if (!response.ok) {
        throw new Error('Kh√¥ng th·ªÉ l·∫•y danh s√°ch phim');
      }

      const data = await response.json();
      displayMovies(data.results);
    } catch (error) {
      console.error('L·ªói khi l·∫•y danh s√°ch phim:', error);
      document.getElementById('movies-list').innerHTML = '<p class="text-danger">Kh√¥ng th·ªÉ t·∫£i danh s√°ch phim.</p>';
    }
  }

  // Hi·ªÉn th·ªã danh s√°ch phim
  function displayMovies(movies) {
    const container = document.getElementById('movies-list');
    container.innerHTML = '';

    if (movies.length === 0) {
      container.innerHTML = '<p class="text-center">Kh√¥ng c√≥ phim n√†o trong th·ªÉ lo·∫°i n√†y.</p>';
      return;
    }

    movies.forEach(movie => {
      const movieCard = document.createElement('div');
      movieCard.className = 'col-md-3 movie-card';
      movieCard.innerHTML = `
                <a href="/details?movieId=${movie.id}" style="text-decoration: none; color: inherit;">
                    <div class="card">
                        <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" class="card-img-top" alt="${movie.title}">
                        <div class="card-body">
                            <h6 class="card-title">${movie.title}</h6>
                            <p><strong>Ng√†y ph√°t h√†nh:</strong> ${movie.release_date || 'N/A'}</p>
                            <p><strong>ƒê√°nh gi√°:</strong> ${movie.vote_average || 'N/A'} / 10</p>
                        </div>
                    </div>
                </a>
            `;
      container.appendChild(movieCard);
    });
  }

  // G·ªçi API khi t·∫£i trang
  fetchMoviesByGenre();
</script>

</body>
</html>
